<h1><%= @timetable.title %></h1>

<% if @timetable.parity? %>
  <h3>Нечетные недели:</h3>
  <%= render partial: 'workplace/weeks/weeks_list', locals: { weeks: @timetable.weeks.odd } %>
  <h3>Четные недели:</h3>
  <%= render partial: 'workplace/weeks/weeks_list', locals: { weeks: @timetable.weeks.even } %>
<% else %>
  <%= render partial: 'workplace/weeks/weeks_list', locals: { weeks: @timetable.weeks } %>
<% end %>

<% if @timetable.draft? %>
  <%= link_to "Опубликовать", to_published_workplace_timetable_path(@timetable), method: :put %>
<% else %>
  <%= link_to "Вернуть в черновики", to_draft_workplace_timetable_path(@timetable), method: :put %>
<% end %>

<div>
  <%= render @timetable %>
</div>

<div class="lesson_time_wrapper">
  <ul class='tabbed_links'>
    <% (1..7).each do |day| %>
      <li><%= link_to day, '#', :class => 'tabbed_link', :id => "day_#{day}" %></li>
    <% end %>
  </ul>
  <div class='tabbed ajaxed lesson_times'>
    <% (1..7).each do |day| %>
      <ul class='day_<%= day %> target'>
        <% lesson_times_for_day = @timetable.lesson_times.for_day(day) %>
        <% (1..lesson_times_for_day.maximum(:number).to_i).each do |number| %>
          <li class='ajax_item'>
            <% lesson_time = lesson_times_for_day.for_number(number) %>
            <% if lesson_time.any? %>
              <%= render lesson_time %>
            <% else %>
              <%= number %> нет занятия в это время
            <% end %>
          </li>
        <% end %>
        <li class='ajax_item'>
          <%= link_to "добавить", new_workplace_timetable_lesson_time_path(@timetable, 'lesson_time[day]' => day), :remote => true, :class => 'new_link' %>
        </li>
      </ul>
    <% end %>
  </div>
</div>
